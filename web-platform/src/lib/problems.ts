import fs from 'fs/promises';
import path from 'path';

// ============================================================
// é¢˜ç›®ç±»å‹å®šä¹‰ (Type Definitions)
// ============================================================

export type ProblemKind = 'code' | 'quiz' | 'reading' | 'intro';
export type QuizKind = 'single' | 'true_false' | 'fill';

/**
 * é¢˜ç›®æ˜¾ç¤ºç±»å‹
 * - standard: æ ‡å‡†ä»£ç ç¼–è¾‘ï¼ˆå•æ–‡ä»¶ï¼‰
 * - multi_file: å¤šæ–‡ä»¶ç¼–è¾‘
 * - reading: é˜…è¯»ç†è§£ï¼ˆæ˜¾ç¤ºä»£ç ï¼Œå­¦ç”Ÿå¡«å†™ç­”æ¡ˆï¼‰
 * - testgen: æµ‹è¯•ç”Ÿæˆï¼ˆå­¦ç”Ÿç¼–å†™æµ‹è¯•è¾“å…¥ï¼‰
 * - project: ç»¼åˆé¡¹ç›®
 */
export type DisplayType = 'standard' | 'multi_file' | 'reading' | 'testgen' | 'project';

export interface ProblemMeta {
  id: string;
  displayType: DisplayType;
  editableFiles: string[];
  readonlyFiles?: string[];  // åªè¯»å±•ç¤ºçš„æ–‡ä»¶
  descriptionZh: string;     // ä¸­æ–‡æè¿°
  learningGoals?: string[];  // å­¦ä¹ ç›®æ ‡
  hints?: string[];          // æç¤º
}

// ============================================================
// é¢˜ç›®é…ç½® (Problem Configuration)
// ============================================================

const PROBLEM_META: Record<string, ProblemMeta> = {
  '00_hello': {
    id: '00_hello',
    displayType: 'standard',
    editableFiles: ['hello.txt'],
    descriptionZh: `# Hello World å…¥é—¨ç»ƒä¹ 

## ä»»åŠ¡æè¿°
åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«ç‰¹å®šå†…å®¹çš„æ–‡æœ¬æ–‡ä»¶ã€‚

## å…·ä½“è¦æ±‚
1. ç¼–è¾‘å³ä¾§çš„ \`hello.txt\` æ–‡ä»¶
2. åœ¨æ–‡ä»¶ä¸­å†™å…¥å•è¯ \`hello\`ï¼ˆå…¨éƒ¨å°å†™ï¼‰
3. ä¸è¦æ·»åŠ ä»»ä½•å¤šä½™çš„ç©ºæ ¼æˆ–æ¢è¡Œ

## å­¦ä¹ ç›®æ ‡
- ç†Ÿæ‚‰åœ¨çº¿ç¼–è¾‘ç¯å¢ƒ
- ç†è§£æ–‡ä»¶å†…å®¹çš„ç²¾ç¡®åŒ¹é…æ¦‚å¿µ`,
    learningGoals: ['ç†Ÿæ‚‰ç¼–è¾‘ç¯å¢ƒ', 'ç†è§£ç²¾ç¡®åŒ¹é…']
  },

  '01_apple': {
    id: '01_apple',
    displayType: 'standard',
    editableFiles: ['fruit.txt'],
    descriptionZh: `# æ°´æœç»ƒä¹ 

## ä»»åŠ¡æè¿°
ç¼–è¾‘æ–‡æœ¬æ–‡ä»¶ï¼Œå†™å…¥æŒ‡å®šçš„æ°´æœåç§°ã€‚

## å…·ä½“è¦æ±‚
1. ç¼–è¾‘ \`fruit.txt\` æ–‡ä»¶
2. å†™å…¥å•è¯ \`apple\`ï¼ˆå…¨éƒ¨å°å†™ï¼‰
3. æäº¤å¹¶æ£€æŸ¥ç»“æœ`,
    learningGoals: ['æ–‡ä»¶ç¼–è¾‘', 'å†…å®¹æäº¤']
  },

  '04_compile': {
    id: '04_compile',
    displayType: 'standard',
    editableFiles: ['hello.c'],
    descriptionZh: `# ç¼–è¯‘åŸç†åˆæ¢

## ä»»åŠ¡æè¿°
ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ª C ç¨‹åºï¼Œè¾“å‡º "Hello World"ã€‚

## å…·ä½“è¦æ±‚
1. ç¼–è¾‘ \`hello.c\` æ–‡ä»¶
2. ç¼–å†™ä¸€ä¸ª \`main\` å‡½æ•°
3. ä½¿ç”¨ \`printf\` è¾“å‡º \`Hello World\` å¹¶æ¢è¡Œ

## ç¤ºä¾‹è¾“å‡º
\`\`\`
Hello World
\`\`\`

## å­¦ä¹ ç›®æ ‡
- ç†è§£ C ç¨‹åºçš„åŸºæœ¬ç»“æ„
- å­¦ä¼šä½¿ç”¨ \`printf\` å‡½æ•°
- ç†è§£ç¼–è¯‘è¿‡ç¨‹

## æç¤º
- éœ€è¦åŒ…å«å¤´æ–‡ä»¶ \`<stdio.h>\`
- \`printf\` ä¸­ä½¿ç”¨ \`\\n\` è¡¨ç¤ºæ¢è¡Œ`,
    learningGoals: ['Cç¨‹åºç»“æ„', 'printfä½¿ç”¨', 'ç¼–è¯‘è¿‡ç¨‹'],
    hints: ['åŒ…å« <stdio.h>', 'ä½¿ç”¨ \\n æ¢è¡Œ']
  },

  '02_code1': {
    id: '02_code1',
    displayType: 'standard',
    editableFiles: ['code1.c'],
    descriptionZh: `# Max å‡½æ•°å®ç°

## ä»»åŠ¡æè¿°
å®ç°ä¸€ä¸ªè¿”å›ä¸¤ä¸ªæ•´æ•°ä¸­è¾ƒå¤§å€¼çš„å‡½æ•°ã€‚

## å…·ä½“è¦æ±‚
1. å®ç°å‡½æ•° \`int max(int a, int b)\`
   - è¿”å› \`a\` å’Œ \`b\` ä¸­çš„è¾ƒå¤§å€¼
   
2. å®ç° \`main\` å‡½æ•°ï¼Œè°ƒç”¨ \`max\` å¹¶è¾“å‡ºç»“æœ
   - è¾“å‡ºæ ¼å¼ï¼š\`max(a,b) is result\`

## æµ‹è¯•ç”¨ä¾‹
ä½ çš„ç¨‹åºåº”è¯¥è¾“å‡ºï¼š
\`\`\`
max(42,-69) is 42
max(33,0) is 33
max(0x123456,123456) is 1193046
max(0x451215AF,0x913591AF) is 1158813103
\`\`\`

## å­¦ä¹ ç›®æ ‡
- æŒæ¡ if-else æ¡ä»¶åˆ¤æ–­
- ç†è§£å‡½æ•°å®šä¹‰ä¸è°ƒç”¨
- å¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆè´Ÿæ•°ã€å¤§æ•°ï¼‰

## æç¤º
- æ³¨æ„è´Ÿæ•°çš„æ¯”è¾ƒ
- è€ƒè™‘ä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦ \`?\``,
    learningGoals: ['if-else è¯­å¥', 'å‡½æ•°å®šä¹‰', 'è¾¹ç•Œå¤„ç†'],
    hints: ['å¤„ç†è´Ÿæ•°', 'å¯ç”¨ä¸‰å…ƒè¿ç®—ç¬¦']
  },

  '03_code2': {
    id: '03_code2',
    displayType: 'standard',
    editableFiles: ['code2.c'],
    descriptionZh: `# æ‰“å°ä¸‰è§’å½¢

## ä»»åŠ¡æè¿°
å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ‰“å°ç”± \`*\` ç»„æˆçš„ç›´è§’ä¸‰è§’å½¢ã€‚

## å…·ä½“è¦æ±‚
1. å®ç°å‡½æ•° \`int printTriangle(int size)\`
   - æ‰“å°ä¸€ä¸ªé«˜åº¦ä¸º \`size\` çš„ç›´è§’ä¸‰è§’å½¢
   - ç¬¬ 1 è¡Œæœ‰ 1 ä¸ª \`*\`ï¼Œç¬¬ 2 è¡Œæœ‰ 2 ä¸ª \`*\`ï¼Œä»¥æ­¤ç±»æ¨
   - è¿”å›æ‰“å°çš„ \`*\` æ€»æ•°

2. \`main\` å‡½æ•°éœ€è¦ï¼š
   - æ‰“å° \`Here is a triangle with height X\`
   - è°ƒç”¨ \`printTriangle\`
   - æ‰“å° \`That triangle had N total stars\`

## ç¤ºä¾‹è¾“å‡ºï¼ˆheight=4ï¼‰
\`\`\`
Here is a triangle with height 4
*
**
***
****
That triangle had 10 total stars
\`\`\`

## å­¦ä¹ ç›®æ ‡
- æŒæ¡åµŒå¥—å¾ªç¯ (Nested Loops)
- ç†è§£å¾ªç¯è®¡æ•°ä¸ç´¯åŠ 
- æ ¼å¼åŒ–è¾“å‡º

## æç¤º
- å¤–å±‚å¾ªç¯æ§åˆ¶è¡Œæ•°
- å†…å±‚å¾ªç¯æ§åˆ¶æ¯è¡Œçš„ \`*\` æ•°é‡
- æ€»æ•°æ˜¯ 1+2+3+...+n = n*(n+1)/2`,
    learningGoals: ['åµŒå¥—å¾ªç¯', 'å¾ªç¯ç´¯åŠ ', 'æ ¼å¼åŒ–è¾“å‡º'],
    hints: ['å¤–å±‚å¾ªç¯æ§åˆ¶è¡Œ', 'å†…å±‚å¾ªç¯æ‰“å°æ˜Ÿå·']
  },

  '05_squares': {
    id: '05_squares',
    displayType: 'standard',
    editableFiles: ['squares.c'],
    descriptionZh: `# å›¾å½¢æ‰“å°é€»è¾‘

## ä»»åŠ¡æè¿°
å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç»˜åˆ¶ä¸¤ä¸ªå¯èƒ½é‡å çš„æ­£æ–¹å½¢ã€‚

## å…·ä½“è¦æ±‚
å®Œæˆ \`squares.c\` ä¸­çš„ \`squares\` å‡½æ•°ï¼š
- å‚æ•°ï¼š\`size1\`, \`x_offset\`, \`y_offset\`, \`size2\`
- ç¬¬ä¸€ä¸ªæ­£æ–¹å½¢ï¼ˆ\`#\`ï¼‰ä» (0,0) å¼€å§‹ï¼Œè¾¹é•¿ä¸º \`size1\`
- ç¬¬äºŒä¸ªæ­£æ–¹å½¢ï¼ˆ\`*\`ï¼‰ä» (x_offset, y_offset) å¼€å§‹ï¼Œè¾¹é•¿ä¸º \`size2\`
- é‡å å¤„ \`*\` ä¼˜å…ˆæ˜¾ç¤º
- ç©ºç™½å¤„æ˜¾ç¤ºç©ºæ ¼

## ç¤ºä¾‹
è°ƒç”¨ \`squares(4, 1, 2, 3)\` åº”è¾“å‡ºï¼š
\`\`\`
####
#  #
#***
#*#*
 ***
\`\`\`

## å­¦ä¹ ç›®æ ‡
- å¤æ‚æ¡ä»¶åˆ¤æ–­
- åæ ‡ç³»è®¡ç®—
- é€»è¾‘è¿ç®—ç¬¦ï¼ˆ&&, ||ï¼‰

## ç¼–è¯‘æ–¹æ³•
\`\`\`bash
gcc -o squares -Wall -Werror -std=gnu99 -pedantic squares.c squares_test.o
./squares 4 1 2 3
\`\`\``,
    learningGoals: ['å¤æ‚æ¡ä»¶åˆ¤æ–­', 'åæ ‡ç³»è®¡ç®—', 'é€»è¾‘è¿ç®—ç¬¦'],
    hints: ['ä»”ç»†é˜…è¯»ä»£ç ä¸­çš„æ³¨é‡Š', 'å…ˆåˆ¤æ–­ * å†åˆ¤æ–­ #']
  },

  '06_rect': {
    id: '06_rect',
    displayType: 'standard',
    editableFiles: ['rectangle.c'],
    descriptionZh: `# çŸ©å½¢å‡ ä½•è®¡ç®—

## ä»»åŠ¡æè¿°
å®šä¹‰çŸ©å½¢ç»“æ„ä½“ï¼Œå®ç°æ ‡å‡†åŒ–å’Œäº¤é›†è®¡ç®—ã€‚

## å…·ä½“è¦æ±‚

### 1. å®šä¹‰ç»“æ„ä½“
\`\`\`c
typedef struct {
  int x, y, width, height;
} rectangle;
\`\`\`

### 2. å®ç° canonicalize å‡½æ•°
\`\`\`c
rectangle canonicalize(rectangle r);
\`\`\`
- ç¡®ä¿ width å’Œ height éè´Ÿ
- è°ƒæ•´ x, y ä½¿çŸ©å½¢è¡¨ç¤ºæ­£ç¡®

ç¤ºä¾‹ï¼š\`{x=3, y=2, width=-2, height=4}\` â†’ \`{x=1, y=2, width=2, height=4}\`

### 3. å®ç° intersection å‡½æ•°
\`\`\`c
rectangle intersection(rectangle r1, rectangle r2);
\`\`\`
- è¿”å›ä¸¤ä¸ªçŸ©å½¢çš„äº¤é›†
- æ— äº¤é›†æ—¶è¿”å› \`width=0, height=0\`

## å­¦ä¹ ç›®æ ‡
- ç»“æ„ä½“ (struct) å®šä¹‰ä¸ä½¿ç”¨
- å‡ ä½•é€»è¾‘å¤„ç†
- è¾¹ç•Œæƒ…å†µå¤„ç†`,
    learningGoals: ['ç»“æ„ä½“å®šä¹‰', 'å‡ ä½•é€»è¾‘', 'è¾¹ç•Œå¤„ç†'],
    hints: ['å…ˆå¤„ç†æ ‡å‡†åŒ–', 'ç”»å›¾åˆ†æäº¤é›†']
  },

  '07_retirement': {
    id: '07_retirement',
    displayType: 'standard',
    editableFiles: ['retirement.c'],
    descriptionZh: `# é€€ä¼‘å‚¨è“„è®¡ç®—å™¨

## ä»»åŠ¡æè¿°
ç¼–å†™ä¸€ä¸ªæ¨¡æ‹Ÿé€€ä¼‘å‚¨è“„è¿‡ç¨‹çš„ç¨‹åºã€‚

## å…·ä½“è¦æ±‚
æ ¹æ®æä¾›çš„æ¨¡æ¿ï¼Œå®ç°é€€ä¼‘å‚¨è“„çš„å¹´åº¦æ¨¡æ‹Ÿï¼š
- è·Ÿè¸ªæ¯å¹´çš„å‚¨è“„ä½™é¢
- è€ƒè™‘å·¥ä½œæœŸé—´çš„å­˜æ¬¾
- è€ƒè™‘é€€ä¼‘åçš„æ”¯å‡º
- å¤„ç†é€šè´§è†¨èƒ€ç­‰å› ç´ 

## å­¦ä¹ ç›®æ ‡
- å¤æ‚ä¸šåŠ¡é€»è¾‘å®ç°
- ç»“æ„ä½“çš„å®é™…åº”ç”¨
- å¾ªç¯ä¸æ¡ä»¶çš„ç»¼åˆè¿ç”¨

## æç¤º
- ä»”ç»†é˜…è¯»ä»£ç ä¸­çš„æ³¨é‡Š
- æ³¨æ„å¹´ä»½çš„è¾¹ç•Œæ¡ä»¶`,
    learningGoals: ['ä¸šåŠ¡é€»è¾‘', 'ç»“æ„ä½“åº”ç”¨', 'ç»¼åˆç¼–ç¨‹']
  },

  '11_read_ptr1': {
    id: '11_read_ptr1',
    displayType: 'reading',
    editableFiles: ['answer.txt', 'Makefile'],
    readonlyFiles: ['test.c'],
    descriptionZh: `# æŒ‡é’ˆé˜…è¯»ç†è§£ I

## ä»»åŠ¡æè¿°
é˜…è¯» \`test.c\` ä¸­çš„ä»£ç ï¼Œæ‰‹åŠ¨æ¨å¯¼ç¨‹åºè¾“å‡ºã€‚

## å…·ä½“è¦æ±‚
1. **ä»”ç»†é˜…è¯»** å³ä¾§çš„ \`test.c\` ä»£ç 
2. **æ‰‹åŠ¨æ‰§è¡Œ** ä»£ç ï¼Œè·Ÿè¸ªå˜é‡å˜åŒ–
3. å°†ç¨‹åºè¾“å‡ºå†™å…¥ \`answer.txt\`
4. åˆ›å»º \`Makefile\` ç¼–è¯‘ \`test.c\` ç”Ÿæˆ \`test\`

## è€ƒå¯Ÿç‚¹
- æŒ‡é’ˆä¼ é€’ vs å€¼ä¼ é€’
- å‡½æ•°è°ƒç”¨æ ˆ
- å˜é‡ä½œç”¨åŸŸ

## å­¦ä¹ ç›®æ ‡
- ç†è§£æŒ‡é’ˆçš„æœ¬è´¨
- æŒæ¡æŒ‰å€¼ä¼ é€’ä¸æŒ‰å¼•ç”¨ä¼ é€’çš„åŒºåˆ«
- èƒ½å¤Ÿæ‰‹åŠ¨æ¨å¯¼ç¨‹åºæ‰§è¡Œè¿‡ç¨‹

## æç¤º
- ç”»å‡ºå†…å­˜å›¾å¸®åŠ©ç†è§£
- æ³¨æ„ \`x++\` å‘ç”Ÿåœ¨ \`*y = *y - x\` ä¹‹å`,
    learningGoals: ['æŒ‡é’ˆç†è§£', 'å€¼ä¼ é€’vså¼•ç”¨ä¼ é€’', 'ç¨‹åºè¿½è¸ª'],
    hints: ['ç”»å†…å­˜å›¾', 'æ³¨æ„æ“ä½œé¡ºåº']
  },

  '12_read_ptr2': {
    id: '12_read_ptr2',
    displayType: 'reading',
    editableFiles: ['answer.txt', 'Makefile'],
    readonlyFiles: ['test.c'],
    descriptionZh: `# æŒ‡é’ˆé˜…è¯»ç†è§£ II

## ä»»åŠ¡æè¿°
è¿›é˜¶æŒ‡é’ˆé˜…è¯»ï¼Œæ¶‰åŠæ›´å¤æ‚çš„å†…å­˜æ“ä½œã€‚

## å…·ä½“è¦æ±‚
1. é˜…è¯» \`test.c\` ä»£ç 
2. æ¨å¯¼å¹¶å†™å‡ºç¨‹åºè¾“å‡ºåˆ° \`answer.txt\`
3. ç¼–å†™ \`Makefile\`

## å­¦ä¹ ç›®æ ‡
- å¤æ‚æŒ‡é’ˆè¿ç®—
- å†…å­˜åœ°å€è®¡ç®—
- å¤šçº§æŒ‡é’ˆç†è§£`,
    learningGoals: ['å¤æ‚æŒ‡é’ˆè¿ç®—', 'å†…å­˜åœ°å€', 'å¤šçº§æŒ‡é’ˆ']
  },

  '13_read_arr1': {
    id: '13_read_arr1',
    displayType: 'reading',
    editableFiles: ['answer.txt', 'Makefile'],
    readonlyFiles: ['test.c'],
    descriptionZh: `# æ•°ç»„æŒ‡é’ˆé˜…è¯»

## ä»»åŠ¡æè¿°
ç†è§£æ•°ç»„åã€ä¸‹æ ‡ä¸æŒ‡é’ˆçš„å…³ç³»ã€‚

## å…·ä½“è¦æ±‚
1. é˜…è¯»æ¶‰åŠæ•°ç»„å’ŒæŒ‡é’ˆçš„ä»£ç 
2. æ¨å¯¼ç¨‹åºè¾“å‡º
3. ç†è§£ \`a[i]\` ä¸ \`*(a+i)\` çš„ç­‰ä»·æ€§

## å­¦ä¹ ç›®æ ‡
- æ•°ç»„ä¸æŒ‡é’ˆçš„å…³ç³»
- æ•°ç»„åçš„æœ¬è´¨
- æŒ‡é’ˆç®—æœ¯è¿ç®—`,
    learningGoals: ['æ•°ç»„ä¸æŒ‡é’ˆå…³ç³»', 'æŒ‡é’ˆç®—æœ¯']
  },

  '14_array_max': {
    id: '14_array_max',
    displayType: 'standard',
    editableFiles: ['arrayMax.c'],
    descriptionZh: `# æ•°ç»„æœ€å¤§å€¼æŸ¥æ‰¾

## ä»»åŠ¡æè¿°
å®ç°åœ¨æ•°ç»„ä¸­æŸ¥æ‰¾æœ€å¤§å€¼çš„å‡½æ•°ã€‚

## å…·ä½“è¦æ±‚
å®ç°å‡½æ•°ï¼š
\`\`\`c
int * arrayMax(int * arr, size_t n);
\`\`\`

- è¿”å›æŒ‡å‘æ•°ç»„ä¸­æœ€å¤§å…ƒç´ çš„æŒ‡é’ˆ
- å¦‚æœæ•°ç»„ä¸ºç©º (n == 0)ï¼Œè¿”å› NULL
- å¦‚æœ arr ä¸º NULLï¼Œè¿”å› NULL

## æµ‹è¯•ç”¨ä¾‹
ç¨‹åºä¼šæµ‹è¯•ï¼š
1. æ­£å¸¸æ•°ç»„æŸ¥æ‰¾
2. åŒ…å«è´Ÿæ•°çš„æ•°ç»„
3. ç©ºæ•°ç»„å¤„ç†
4. NULL æŒ‡é’ˆå¤„ç†

## å­¦ä¹ ç›®æ ‡
- æ•°ç»„éå†
- æŒ‡é’ˆè¿”å›å€¼
- è¾¹ç•Œæ¡ä»¶å¤„ç†`,
    learningGoals: ['æ•°ç»„éå†', 'æŒ‡é’ˆè¿”å›', 'è¾¹ç•Œå¤„ç†'],
    hints: ['æ³¨æ„ç©ºæ•°ç»„', 'è¿”å›æŒ‡é’ˆè€Œéå€¼']
  },

  '08_testing': {
    id: '08_testing',
    displayType: 'testgen',
    editableFiles: ['input.1', 'input.2', 'input.3', 'input.4'],
    descriptionZh: `# é»‘ç›’æµ‹è¯•ç”Ÿæˆ

## ä»»åŠ¡æè¿°
è®¾è®¡æµ‹è¯•è¾“å…¥ï¼Œåˆ†åˆ«å‘ç°4ä¸ªé”™è¯¯ç¨‹åºä¸­çš„ bugã€‚

## èƒŒæ™¯
æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆ¤æ–­ç´ æ•°çš„ç¨‹åºï¼š
- \`isPrime-correct\`: æ­£ç¡®å®ç°
- \`isPrime-broken1\` ~ \`isPrime-broken4\`: 4ä¸ªåŒ…å«ä¸åŒ bug çš„å®ç°

æ‰€æœ‰ç¨‹åºä½¿ç”¨æ–¹å¼ç›¸åŒï¼š
\`\`\`bash
$ ./isPrime-correct 3
3 is prime
$ ./isPrime-correct 4
4 is not prime
\`\`\`

## å…·ä½“è¦æ±‚
ä¸ºæ¯ä¸ª broken ç¨‹åºæ‰¾ä¸€ä¸ªèƒ½æš´éœ²å…¶ bug çš„æµ‹è¯•è¾“å…¥ï¼š

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| \`input.1\` | æš´éœ² isPrime-broken1 çš„ bug |
| \`input.2\` | æš´éœ² isPrime-broken2 çš„ bug |
| \`input.3\` | æš´éœ² isPrime-broken3 çš„ bug |
| \`input.4\` | æš´éœ² isPrime-broken4 çš„ bug |

æ¯ä¸ªæ–‡ä»¶åªéœ€å†™ä¸€ä¸ªæ•´æ•°ã€‚

## æç¤º
- è€ƒè™‘è¾¹ç•Œå€¼ï¼š0, 1, 2, è´Ÿæ•°
- è€ƒè™‘ç‰¹æ®Šç´ æ•°ï¼š2 (æœ€å°ç´ æ•°), 3
- è€ƒè™‘åˆæ•°ï¼š4, 9, 25 (å¹³æ–¹æ•°)

## å­¦ä¹ ç›®æ ‡
- é»‘ç›’æµ‹è¯•æ€ç»´
- è¾¹ç•Œæ¡ä»¶åˆ†æ
- æµ‹è¯•ç”¨ä¾‹è®¾è®¡

## æç¤º
- è€ƒè™‘è¾¹ç•Œå€¼ï¼š0, 1, 2, è´Ÿæ•°
- è€ƒè™‘ç‰¹æ®Šç´ æ•°ï¼š2 æ˜¯å”¯ä¸€çš„å¶ç´ æ•°
- è€ƒè™‘å¤§æ•°å’Œå°æ•°`,
    learningGoals: ['é»‘ç›’æµ‹è¯•', 'è¾¹ç•Œåˆ†æ', 'æµ‹è¯•è®¾è®¡'],
    hints: ['è¯•è¯•è¾¹ç•Œå€¼', '2 æ˜¯ç‰¹æ®Šçš„']
  },

  '15_tests_subseq': {
    id: '15_tests_subseq',
    displayType: 'unittest',
    editableFiles: ['test-subseq.c'],
    descriptionZh: `# å•å…ƒæµ‹è¯•ç¼–å†™ - maxSeq å‡½æ•°

## ä»»åŠ¡æè¿°
ä¸º \`maxSeq\` å‡½æ•°ç¼–å†™å®Œå–„çš„å•å…ƒæµ‹è¯•ï¼Œèƒ½å¤Ÿå‘ç°é”™è¯¯å®ç°ä¸­çš„ bugã€‚

## å‡½æ•°åŸå‹
\`\`\`c
size_t maxSeq(int * array, size_t n);
\`\`\`

è¯¥å‡½æ•°è¿”å›æ•°ç»„ä¸­**æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—**çš„é•¿åº¦ã€‚

ä¾‹å¦‚ï¼š
- \`{1, 2, 3, 4, 5}\` â†’ è¿”å› 5
- \`{1, 2, 1, 2, 3}\` â†’ è¿”å› 3
- \`{5, 4, 3, 2, 1}\` â†’ è¿”å› 1
- \`{}\` (ç©ºæ•°ç»„) â†’ è¿”å› 0

## å…·ä½“è¦æ±‚
åœ¨ \`test-subseq.c\` ä¸­ç¼–å†™æµ‹è¯•ç¨‹åºï¼š

1. **å£°æ˜å‡½æ•°åŸå‹**ï¼ˆåœ¨ #include ä¹‹åï¼‰ï¼š
\`\`\`c
size_t maxSeq(int * array, size_t n);
\`\`\`

2. **ç¼–å†™ main å‡½æ•°**æµ‹è¯•å„ç§æƒ…å†µï¼š
   - æ­£å¸¸é€’å¢åºåˆ—
   - é€’å‡åºåˆ—
   - æ··åˆåºåˆ—
   - è¾¹ç•Œæƒ…å†µï¼ˆç©ºæ•°ç»„ã€å•å…ƒç´ ï¼‰

3. **æµ‹è¯•é€šè¿‡è¿”å›** \`EXIT_SUCCESS\`ï¼Œ**å¤±è´¥è¿”å›** \`EXIT_FAILURE\`

## ç¤ºä¾‹æ¡†æ¶
\`\`\`c
#include <stdio.h>
#include <stdlib.h>

size_t maxSeq(int * array, size_t n);

int main(void) {
    int arr1[] = {1, 2, 3};
    if (maxSeq(arr1, 3) != 3) {
        printf("Test 1 failed!\\n");
        return EXIT_FAILURE;
    }
    // æ›´å¤šæµ‹è¯•...
    printf("All tests passed!\\n");
    return EXIT_SUCCESS;
}
\`\`\`

## å­¦ä¹ ç›®æ ‡
- å•å…ƒæµ‹è¯•ç¼–å†™
- è¾¹ç•Œæ¡ä»¶è¦†ç›–
- æ–­è¨€å’Œè¿”å›å€¼éªŒè¯`,
    learningGoals: ['å•å…ƒæµ‹è¯•', 'è¾¹ç•Œè¦†ç›–', 'æ–­è¨€ä½¿ç”¨'],
    hints: ['æµ‹è¯•ç©ºæ•°ç»„', 'æµ‹è¯•å•å…ƒç´ ', 'æµ‹è¯•å…¨é€’å‡', 'æµ‹è¯•è´Ÿæ•°']
  },

  '16_subseq': {
    id: '16_subseq',
    displayType: 'standard',
    editableFiles: ['maxSeq.c'],
    descriptionZh: `# æœ€é•¿è¿ç»­å­åºåˆ—

## ä»»åŠ¡æè¿°
å®ç°æŸ¥æ‰¾æœ€é•¿é€’å¢è¿ç»­å­åºåˆ—é•¿åº¦çš„å‡½æ•°ã€‚

## å…·ä½“è¦æ±‚
\`\`\`c
size_t maxSeq(int * array, size_t n);
\`\`\`

- è¿”å›æœ€é•¿**ä¸¥æ ¼é€’å¢**è¿ç»­å­åºåˆ—çš„é•¿åº¦
- ä¾‹å¦‚ï¼š\`[1,2,3,1,2]\` è¿”å› 3ï¼ˆåºåˆ— 1,2,3ï¼‰
- ç©ºæ•°ç»„è¿”å› 0

## å­¦ä¹ ç›®æ ‡
- åºåˆ—å¤„ç†ç®—æ³•
- è¾¹ç•Œæ¡ä»¶å¤„ç†
- ç®—æ³•ä¼˜åŒ–æ€ç»´`,
    learningGoals: ['åºåˆ—ç®—æ³•', 'è¾¹ç•Œå¤„ç†', 'ç®—æ³•æ€ç»´']
  },

  '10_gdb': {
    id: '10_gdb',
    displayType: 'gdb',
    editableFiles: ['input.txt'],
    descriptionZh: `# GDB çŒœæ•°å­—æ¸¸æˆ

## ä»»åŠ¡æè¿°
ä½¿ç”¨ GDB è°ƒè¯•å™¨é€†å‘åˆ†æä¸€ä¸ªçŒœæ•°å­—æ¸¸æˆï¼Œæ‰¾å‡ºç§˜å¯†æ•°å­—ã€‚

## èƒŒæ™¯
\`game\` æ˜¯ä¸€ä¸ªç¼–è¯‘å¥½çš„ç¨‹åºï¼ŒåŒ…å«ä¸¤è½®çŒœæ•°å­—ï¼š
- **ç¬¬ä¸€è½®**ï¼šç¨‹åºè°ƒç”¨ \`getSecretNumber()\` ç”Ÿæˆä¸€ä¸ªç§˜å¯†æ•°å­—
- **ç¬¬äºŒè½®**ï¼šç¨‹åºé€šè¿‡å¾ªç¯è®¡ç®—å¾—åˆ°å¦ä¸€ä¸ªç§˜å¯†æ•°å­— \`total\`

ä½ éœ€è¦ä½¿ç”¨ GDB æ‰¾å‡ºè¿™ä¸¤ä¸ªæ•°å­—ã€‚

## æœ¬åœ°æ“ä½œæ­¥éª¤

### 1. å¯åŠ¨ GDB
\`\`\`bash
gdb ./game
\`\`\`

### 2. ç¬¬ä¸€è½® - æ‰¾å‡ºç§˜å¯†æ•°å­—
\`\`\`gdb
(gdb) start          # å¼€å§‹æ‰§è¡Œ
(gdb) next           # å•æ­¥æ‰§è¡Œ
(gdb) next           # ç»§ç»­...
(gdb) print secret   # æ‰“å° secret å˜é‡çš„å€¼
\`\`\`

### 3. ç¬¬äºŒè½® - æ‰¾å‡º total
\`\`\`gdb
(gdb) break 30       # åœ¨å¾ªç¯åè®¾ç½®æ–­ç‚¹ï¼ˆè¡Œå·æ ¹æ®æºç è°ƒæ•´ï¼‰
(gdb) continue       # ç»§ç»­æ‰§è¡Œåˆ°æ–­ç‚¹
(gdb) print total    # æ‰“å° total çš„å€¼
\`\`\`

## æäº¤ç­”æ¡ˆ
åœ¨ \`input.txt\` ä¸­å†™å…¥ä¸¤ä¸ªæ•°å­—ï¼Œæ¯è¡Œä¸€ä¸ªï¼š
\`\`\`
<ç¬¬ä¸€è½®ç§˜å¯†æ•°å­—>
<ç¬¬äºŒè½®ç§˜å¯†æ•°å­—>
\`\`\`

éªŒè¯ç­”æ¡ˆï¼š
\`\`\`bash
./game < input.txt
\`\`\`

æˆåŠŸè¾“å‡ºåº”æ˜¾ç¤º "You win round 2 also!"

## GDB å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥
| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| \`start\` | å¼€å§‹æ‰§è¡Œå¹¶åœåœ¨ main |
| \`next\` / \`n\` | å•æ­¥æ‰§è¡Œï¼ˆä¸è¿›å…¥å‡½æ•°ï¼‰ |
| \`step\` / \`s\` | å•æ­¥æ‰§è¡Œï¼ˆè¿›å…¥å‡½æ•°ï¼‰ |
| \`print var\` | æ‰“å°å˜é‡å€¼ |
| \`break N\` | åœ¨ç¬¬ N è¡Œè®¾æ–­ç‚¹ |
| \`continue\` / \`c\` | ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ |
| \`quit\` | é€€å‡º GDB |
- \`next\` / \`step\` - å•æ­¥æ‰§è¡Œ
- \`print var\` - æŸ¥çœ‹å˜é‡å€¼

## å­¦ä¹ ç›®æ ‡
- GDB åŸºæœ¬ä½¿ç”¨
- ç¨‹åºè°ƒè¯•æŠ€å·§
- é€†å‘æ€ç»´`,
    learningGoals: ['GDBä½¿ç”¨', 'è°ƒè¯•æŠ€å·§', 'é€†å‘æ€ç»´']
  },

  'c2prj1_cards': {
    id: 'c2prj1_cards',
    displayType: 'multi_file',
    editableFiles: ['cards.c', 'cards.h'],
    readonlyFiles: ['Makefile'],
    descriptionZh: `# æ‰‘å…‹ç‰ŒåŸºç¡€åº“å®ç°

## é¡¹ç›®èƒŒæ™¯
è¿™æ˜¯ä¸€ä¸ªæ‰‘å…‹ç‰Œæ¸¸æˆé¡¹ç›®çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚ä½ å°†å®ç°è¡¨ç¤ºæ‰‘å…‹ç‰Œçš„åŸºç¡€æ•°æ®ç»“æ„å’Œæ“ä½œå‡½æ•°ã€‚

## éœ€è¦å®ç°çš„å‡½æ•°

### 1. assert_card_valid
\`\`\`c
void assert_card_valid(card_t c);
\`\`\`
éªŒè¯å¡ç‰Œçš„å€¼å’ŒèŠ±è‰²æ˜¯å¦æœ‰æ•ˆã€‚

### 2. ranking_to_string
\`\`\`c
const char * ranking_to_string(hand_ranking_t r);
\`\`\`
å°†ç‰Œå‹æšä¸¾è½¬æ¢ä¸ºå­—ç¬¦ä¸²æè¿°ã€‚

### 3. value_letter
\`\`\`c
char value_letter(card_t c);
\`\`\`
è¿”å›å¡ç‰Œå€¼çš„å­—ç¬¦è¡¨ç¤ºï¼ˆ2-9, 0, J, Q, K, Aï¼‰ã€‚

### 4. suit_letter
\`\`\`c
char suit_letter(card_t c);
\`\`\`
è¿”å›èŠ±è‰²å­—ç¬¦ï¼ˆs, h, d, cï¼‰ã€‚

### 5. print_card
\`\`\`c
void print_card(card_t c);
\`\`\`
æ‰“å°å¡ç‰Œï¼ˆå¦‚ "As", "Kc"ï¼‰ã€‚

### 6. card_from_letters
\`\`\`c
card_t card_from_letters(char value_let, char suit_let);
\`\`\`
ä»å­—ç¬¦åˆ›å»ºå¡ç‰Œç»“æ„ã€‚

### 7. card_from_num
\`\`\`c
card_t card_from_num(unsigned c);
\`\`\`
ä»æ•°å­— [0,52) æ˜ å°„åˆ°å”¯ä¸€å¡ç‰Œã€‚

## ç¼–è¯‘æµ‹è¯•
\`\`\`bash
make test    # ç¼–è¯‘æµ‹è¯•ç¨‹åº
make poker   # ç¼–è¯‘å®Œæ•´æ¸¸æˆ
\`\`\`

## å­¦ä¹ ç›®æ ‡
- ç»“æ„ä½“ä¸æšä¸¾
- æ¨¡å—åŒ–ç¼–ç¨‹
- å¤´æ–‡ä»¶è®¾è®¡`,
    learningGoals: ['ç»“æ„ä½“æšä¸¾', 'æ¨¡å—åŒ–ç¼–ç¨‹', 'å¤´æ–‡ä»¶è®¾è®¡']
  },

  'c2prj2_testing': {
    id: 'c2prj2_testing',
    displayType: 'testgen',
    editableFiles: ['tests.txt'],
    descriptionZh: `# æ‰‘å…‹ç‰Œæ‰‹ç‰Œè¯„ä¼° - æµ‹è¯•ç”¨ä¾‹ç¼–å†™

## ä»»åŠ¡æè¿°
ä¸ºæ‰‘å…‹ç‰Œè¯„ä¼°ç¨‹åºè®¾è®¡æµ‹è¯•ç”¨ä¾‹ï¼Œæ‰¾å‡ºé”™è¯¯å®ç°ä¸­çš„ bugã€‚

## èƒŒæ™¯
æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª \`test-eval\` ç¨‹åºï¼Œå®ƒå¯ä»¥è¯»å–æµ‹è¯•æ–‡ä»¶å¹¶è¯„ä¼°ä¸¤æ‰‹æ‰‘å…‹ç‰Œçš„è¾“èµ¢ã€‚æ¯è¡Œæ ¼å¼ä¸ºï¼š

\`\`\`
æ‰‹ç‰Œ1; æ‰‹ç‰Œ2
\`\`\`

ä¾‹å¦‚ï¼š
\`\`\`
0c 0s 8s 7d 6d 6s 5c; Js 0s 8s 7d 6s 5c 4c
\`\`\`

## å…·ä½“è¦æ±‚
åœ¨ \`tests.txt\` ä¸­ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–ä»¥ä¸‹ç‰Œå‹ï¼š
- é«˜ç‰Œ (Nothing)
- å¯¹å­ (Pair)
- ä¸¤å¯¹ (Two Pair)
- ä¸‰æ¡ (Three of a Kind)
- é¡ºå­ (Straight) âš ï¸ å®¹æ˜“å‡ºé”™
- åŒèŠ± (Flush)
- è‘«èŠ¦ (Full House)
- å››æ¡ (Four of a Kind)
- åŒèŠ±é¡º (Straight Flush)

## ç‰Œé¢è¡¨ç¤º
- æ•°å€¼: 2-9, 0(10), J, Q, K, A
- èŠ±è‰²: s(é»‘æ¡ƒ), h(çº¢å¿ƒ), d(æ–¹å—), c(æ¢…èŠ±)
- ä¾‹å¦‚: \`As\` = é»‘æ¡ƒA, \`0h\` = çº¢å¿ƒ10

## æç¤º
- é¡ºå­åˆ¤æ–­å®¹æ˜“æœ‰ off-by-one é”™è¯¯
- åŒèŠ±é¡ºä¸ç­‰äº"æœ‰é¡ºå­ä¸”æœ‰åŒèŠ±"
- ä¸¤å¯¹çš„æ’åºæœ‰ç»†å¾®å·®åˆ«
- æ³¨æ„è¾¹ç•Œæƒ…å†µ

## å­¦ä¹ ç›®æ ‡
- é»‘ç›’æµ‹è¯•è®¾è®¡
- è¾¹ç•Œæ¡ä»¶åˆ†æ
- ç­‰ä»·ç±»åˆ’åˆ†`,
    learningGoals: ['é»‘ç›’æµ‹è¯•', 'è¾¹ç•Œåˆ†æ', 'ç­‰ä»·ç±»åˆ’åˆ†'],
    hints: ['é¡ºå­å®¹æ˜“å‡ºé”™', 'æµ‹è¯•è¾¹ç•Œå€¼', 'è€ƒè™‘ A-2-3-4-5 çš„å°é¡ºå­']
  },

  // ============================================================
  // æ–°å¢ï¼šå¯¼è¯»è¯¾ (Intro Lessons)
  // ============================================================
  
  'intro_what_is_c': {
    id: 'intro_what_is_c',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä»€ä¹ˆæ˜¯Cè¯­è¨€ï¼Ÿ

## å¯¼è¯»

æ¬¢è¿æ¥åˆ°Cè¯­è¨€çš„ä¸–ç•Œï¼åœ¨å¼€å§‹ç¼–ç¨‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚

### Cè¯­è¨€çš„å†å²

Cè¯­è¨€è¯ç”Ÿäº **1972å¹´**ï¼Œç”±è´å°”å®éªŒå®¤çš„ **ä¸¹å°¼æ–¯Â·é‡Œå¥‡ï¼ˆDennis Ritchieï¼‰** å‘æ˜ã€‚å®ƒæœ€åˆæ˜¯ä¸ºäº†å¼€å‘ UNIX æ“ä½œç³»ç»Ÿè€Œè®¾è®¡çš„ã€‚

### Cè¯­è¨€çš„ç‰¹ç‚¹

1. **é«˜æ•ˆ**ï¼šCè¯­è¨€ç”Ÿæˆçš„ç¨‹åºè¿è¡Œé€Ÿåº¦éå¸¸å¿«
2. **åº•å±‚**ï¼šå¯ä»¥ç›´æ¥æ“ä½œå†…å­˜å’Œç¡¬ä»¶
3. **å¯ç§»æ¤**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„ç¼–è¯‘
4. **åŸºç¡€**ï¼šæ˜¯è®¸å¤šç°ä»£è¯­è¨€ï¼ˆC++ã€Javaã€Pythonï¼‰çš„"ç¥–å…ˆ"

### ç¼–è¯‘å‹è¯­è¨€ vs è§£é‡Šå‹è¯­è¨€

Cè¯­è¨€æ˜¯**ç¼–è¯‘å‹è¯­è¨€**ï¼Œè¿™æ„å‘³ç€ï¼š

\`\`\`
æºä»£ç  (.cæ–‡ä»¶) â†’ [ç¼–è¯‘å™¨] â†’ å¯æ‰§è¡Œæ–‡ä»¶ â†’ è¿è¡Œ
\`\`\`

ä¸ Python ç­‰**è§£é‡Šå‹è¯­è¨€**ä¸åŒï¼ŒCç¨‹åºéœ€è¦å…ˆ"ç¿»è¯‘"æˆæœºå™¨ç æ‰èƒ½æ‰§è¡Œã€‚

### ä¸ºä»€ä¹ˆå­¦ä¹ Cè¯­è¨€ï¼Ÿ

- ç†è§£è®¡ç®—æœºåº•å±‚åŸç†
- åŸ¹å…»é«˜æ•ˆç¼–ç¨‹æ€ç»´
- ä¸ºå­¦ä¹ å…¶ä»–è¯­è¨€æ‰“ä¸‹åŸºç¡€
- åµŒå…¥å¼å¼€å‘ã€æ“ä½œç³»ç»Ÿå¼€å‘çš„å¿…å¤‡æŠ€èƒ½

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['äº†è§£Cè¯­è¨€å†å²', 'ç†è§£ç¼–è¯‘å‹è¯­è¨€']
  },

  'intro_compile_errors': {
    id: 'intro_compile_errors',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# å¦‚ä½•é˜…è¯»ç¼–è¯‘é”™è¯¯ï¼Ÿ

## å¯¼è¯»

å½“ä½ çš„ä»£ç æœ‰é—®é¢˜æ—¶ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºé”™è¯¯ä¿¡æ¯ã€‚å­¦ä¼šé˜…è¯»è¿™äº›ä¿¡æ¯ï¼Œæ˜¯æˆä¸ºç¨‹åºå‘˜çš„ç¬¬ä¸€æ­¥ã€‚

### å¸¸è§é”™è¯¯ç±»å‹

#### 1. è¯­æ³•é”™è¯¯ (Syntax Error)
\`\`\`
error: expected ';' before 'return'
\`\`\`
**å«ä¹‰**ï¼šåœ¨ return ä¹‹å‰åº”è¯¥æœ‰åˆ†å·  
**è§£å†³**ï¼šæ£€æŸ¥ä¸Šä¸€è¡Œæ˜¯å¦ç¼ºå°‘åˆ†å·

#### 2. æœªå£°æ˜çš„å˜é‡
\`\`\`
error: 'x' undeclared
\`\`\`
**å«ä¹‰**ï¼šä½¿ç”¨äº†ä¸€ä¸ªæ²¡æœ‰å®šä¹‰çš„å˜é‡ x  
**è§£å†³**ï¼šå…ˆå£°æ˜å˜é‡å†ä½¿ç”¨

#### 3. ç±»å‹é”™è¯¯
\`\`\`
warning: format '%d' expects 'int', but argument 2 has type 'double'
\`\`\`
**å«ä¹‰**ï¼šprintf çš„ %d éœ€è¦ intï¼Œä½†ä½ ä¼ äº† double  
**è§£å†³**ï¼šä½¿ç”¨ %f æ¥æ‰“å° double

### é˜…è¯»é”™è¯¯ä¿¡æ¯çš„æŠ€å·§

1. **çœ‹æ–‡ä»¶åå’Œè¡Œå·**ï¼š\`hello.c:5:10\` è¡¨ç¤ºç¬¬5è¡Œç¬¬10åˆ—
2. **ä»ç¬¬ä¸€ä¸ªé”™è¯¯å¼€å§‹ä¿®**ï¼šæœ‰æ—¶ä¸€ä¸ªé”™è¯¯ä¼šå¯¼è‡´åé¢çš„è¿é”é”™è¯¯
3. **æ³¨æ„ error vs warning**ï¼šerror å¿…é¡»ä¿®å¤ï¼Œwarning å»ºè®®ä¿®å¤

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£ç¼–è¯‘é”™è¯¯', 'å­¦ä¼šé˜…è¯»é”™è¯¯ä¿¡æ¯']
  },

  'intro_variables': {
    id: 'intro_variables',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# å˜é‡æ˜¯ä»€ä¹ˆï¼Ÿ

## å¯¼è¯»

**å˜é‡**æ˜¯ç¨‹åºä¸­ç”¨æ¥å­˜å‚¨æ•°æ®çš„"å®¹å™¨"ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª**å¸¦æ ‡ç­¾çš„ç›’å­**ã€‚

### å˜é‡çš„ä¸‰è¦ç´ 

1. **ç±»å‹**ï¼šç›’å­èƒ½è£…ä»€ä¹ˆï¼ˆæ•´æ•°ï¼Ÿå°æ•°ï¼Ÿå­—ç¬¦ï¼Ÿï¼‰
2. **åå­—**ï¼šç›’å­çš„æ ‡ç­¾ï¼ˆæ–¹ä¾¿ä½ æ‰¾åˆ°å®ƒï¼‰
3. **å€¼**ï¼šç›’å­é‡Œçš„å†…å®¹

### Cè¯­è¨€çš„åŸºæœ¬æ•°æ®ç±»å‹

| ç±»å‹ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| \`int\` | æ•´æ•° | \`int age = 20;\` |
| \`float\` | å°æ•° | \`float price = 9.99;\` |
| \`double\` | æ›´ç²¾ç¡®çš„å°æ•° | \`double pi = 3.14159;\` |
| \`char\` | å•ä¸ªå­—ç¬¦ | \`char grade = 'A';\` |

### å˜é‡å£°æ˜å’Œèµ‹å€¼

\`\`\`c
// å…ˆå£°æ˜ï¼Œåèµ‹å€¼
int x;
x = 10;

// å£°æ˜çš„åŒæ—¶èµ‹å€¼
int y = 20;
\`\`\`

### å˜é‡å‘½åè§„åˆ™

- âœ… å¯ä»¥ä½¿ç”¨ï¼šå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
- âŒ ä¸èƒ½ç”¨æ•°å­—å¼€å¤´
- âŒ ä¸èƒ½ä½¿ç”¨å…³é”®å­—ï¼ˆå¦‚ int, if, forï¼‰
- ğŸ’¡ å»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„åå­—ï¼š\`studentAge\` ä¼˜äº \`a\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£å˜é‡æ¦‚å¿µ', 'æŒæ¡æ•°æ®ç±»å‹']
  },

  'intro_if_else': {
    id: 'intro_if_else',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ç¨‹åºå¦‚ä½•åšå†³ç­–ï¼Ÿ

## å¯¼è¯»

ç”Ÿæ´»ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦åšå†³ç­–ï¼š
- **å¦‚æœ**ä¸‹é›¨ï¼Œ**å°±**å¸¦ä¼
- **å¦‚æœ**è€ƒè¯•åŠæ ¼ï¼Œ**å°±**å¥–åŠ±è‡ªå·±ï¼›**å¦åˆ™**ï¼Œç»§ç»­åŠªåŠ›

ç¨‹åºä¹Ÿéœ€è¦è¿™æ ·çš„"å†³ç­–èƒ½åŠ›"ï¼Œè¿™å°±æ˜¯ **if-else è¯­å¥**ã€‚

### if-else çš„åŸºæœ¬è¯­æ³•

\`\`\`c
if (æ¡ä»¶) {
    // æ¡ä»¶ä¸ºçœŸæ—¶æ‰§è¡Œ
} else {
    // æ¡ä»¶ä¸ºå‡æ—¶æ‰§è¡Œ
}
\`\`\`

### ç¤ºä¾‹ï¼šåˆ¤æ–­æˆç»©

\`\`\`c
int score = 85;

if (score >= 60) {
    printf("åŠæ ¼\\n");
} else {
    printf("ä¸åŠæ ¼\\n");
}
\`\`\`

### Cè¯­è¨€ä¸­çš„"çœŸ"ä¸"å‡"

åœ¨Cè¯­è¨€ä¸­ï¼š
- **0** è¡¨ç¤º **å‡ (false)**
- **é0** è¡¨ç¤º **çœŸ (true)**

\`\`\`c
if (0)  // ä¸ä¼šæ‰§è¡Œ
if (1)  // ä¼šæ‰§è¡Œ
if (-1) // ä¹Ÿä¼šæ‰§è¡Œï¼ˆé0å°±æ˜¯çœŸï¼‰
\`\`\`

### æ¯”è¾ƒè¿ç®—ç¬¦

| è¿ç®—ç¬¦ | å«ä¹‰ | ç¤ºä¾‹ |
|--------|------|------|
| \`==\` | ç­‰äº | \`a == b\` |
| \`!=\` | ä¸ç­‰äº | \`a != b\` |
| \`>\` | å¤§äº | \`a > b\` |
| \`<\` | å°äº | \`a < b\` |
| \`>=\` | å¤§äºç­‰äº | \`a >= b\` |
| \`<=\` | å°äºç­‰äº | \`a <= b\` |

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£æ¡ä»¶åˆ¤æ–­', 'æŒæ¡æ¯”è¾ƒè¿ç®—ç¬¦']
  },

  'intro_loops': {
    id: 'intro_loops',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä¸ºä»€ä¹ˆéœ€è¦å¾ªç¯ï¼Ÿ

## å¯¼è¯»

å‡è®¾ä½ éœ€è¦æ‰“å° 1 åˆ° 100 çš„æ‰€æœ‰æ•°å­—ã€‚å¦‚æœä¸ç”¨å¾ªç¯ï¼š

\`\`\`c
printf("1\\n");
printf("2\\n");
printf("3\\n");
// ... è¿˜è¦å†™ 97 è¡Œï¼
\`\`\`

è¿™å¤ªè ¢äº†ï¼**å¾ªç¯**è®©ä½ åªéœ€è¦å†™å‡ è¡Œä»£ç å°±èƒ½å®Œæˆé‡å¤çš„ä»»åŠ¡ã€‚

### for å¾ªç¯

å½“ä½ çŸ¥é“è¦å¾ªç¯å¤šå°‘æ¬¡æ—¶ï¼Œä½¿ç”¨ \`for\`ï¼š

\`\`\`c
for (int i = 1; i <= 100; i++) {
    printf("%d\\n", i);
}
\`\`\`

**æ‹†è§£**ï¼š
- \`int i = 1\` â€” åˆå§‹åŒ–ï¼šä» 1 å¼€å§‹
- \`i <= 100\` â€” æ¡ä»¶ï¼šåªè¦ i â‰¤ 100 å°±ç»§ç»­
- \`i++\` â€” æ›´æ–°ï¼šæ¯æ¬¡å¾ªç¯å i åŠ  1

### while å¾ªç¯

å½“ä½ ä¸ç¡®å®šè¦å¾ªç¯å¤šå°‘æ¬¡æ—¶ï¼Œä½¿ç”¨ \`while\`ï¼š

\`\`\`c
int n = 1;
while (n <= 100) {
    printf("%d\\n", n);
    n++;
}
\`\`\`

### åµŒå¥—å¾ªç¯

å¾ªç¯é‡Œé¢å¯ä»¥å†å¥—å¾ªç¯ï¼š

\`\`\`c
// æ‰“å°ä¹ä¹ä¹˜æ³•è¡¨
for (int i = 1; i <= 9; i++) {
    for (int j = 1; j <= i; j++) {
        printf("%dÃ—%d=%d ", j, i, i*j);
    }
    printf("\\n");
}
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£å¾ªç¯çš„æ„ä¹‰', 'æŒæ¡ for å’Œ while']
  },

  'intro_functions': {
    id: 'intro_functions',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä»€ä¹ˆæ˜¯å‡½æ•°ï¼Ÿ

## å¯¼è¯»

**å‡½æ•°**æ˜¯ä¸€æ®µæœ‰åå­—çš„ä»£ç å—ï¼Œå¯ä»¥è¢«é‡å¤è°ƒç”¨ã€‚

å°±åƒæ•°å­¦ä¸­çš„å‡½æ•° f(x) = x + 1ï¼Œç¨‹åºä¸­çš„å‡½æ•°ä¹Ÿæ˜¯ï¼š**è¾“å…¥ â†’ å¤„ç† â†’ è¾“å‡º**

### å‡½æ•°çš„åŸºæœ¬ç»“æ„

\`\`\`c
è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°åˆ—è¡¨) {
    // å‡½æ•°ä½“
    return è¿”å›å€¼;
}
\`\`\`

### ç¤ºä¾‹ï¼šè®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œ

\`\`\`c
int add(int a, int b) {
    return a + b;
}

// è°ƒç”¨å‡½æ•°
int result = add(3, 5);  // result = 8
\`\`\`

### ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°ï¼Ÿ

1. **ä»£ç å¤ç”¨**ï¼šå†™ä¸€æ¬¡ï¼Œç”¨å¤šæ¬¡
2. **æ¨¡å—åŒ–**ï¼šæŠŠå¤§é—®é¢˜åˆ†è§£æˆå°é—®é¢˜
3. **æ˜“äºç»´æŠ¤**ï¼šä¿®æ”¹ä¸€å¤„ï¼Œå¤„å¤„ç”Ÿæ•ˆ

### void å‡½æ•°

å¦‚æœå‡½æ•°ä¸éœ€è¦è¿”å›å€¼ï¼Œä½¿ç”¨ \`void\`ï¼š

\`\`\`c
void sayHello() {
    printf("Hello!\\n");
}
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£å‡½æ•°æ¦‚å¿µ', 'æŒæ¡å‡½æ•°å®šä¹‰å’Œè°ƒç”¨']
  },

  'intro_struct': {
    id: 'intro_struct',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä¸ºä»€ä¹ˆéœ€è¦ç»“æ„ä½“ï¼Ÿ

## å¯¼è¯»

å‡è®¾ä½ è¦å­˜å‚¨ä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯ï¼šå§“åã€å¹´é¾„ã€æˆç»©ã€‚

**ç¬¨åŠæ³•**ï¼šç”¨å¤šä¸ªå˜é‡
\`\`\`c
char name1[50] = "å¼ ä¸‰";
int age1 = 20;
float score1 = 85.5;

char name2[50] = "æå››";
int age2 = 21;
float score2 = 90.0;
// å¤ªä¹±äº†ï¼
\`\`\`

**èªæ˜åŠæ³•**ï¼šç”¨ç»“æ„ä½“æŠŠç›¸å…³æ•°æ®"æ‰“åŒ…"

\`\`\`c
struct Student {
    char name[50];
    int age;
    float score;
};

struct Student s1 = {"å¼ ä¸‰", 20, 85.5};
struct Student s2 = {"æå››", 21, 90.0};
\`\`\`

### ç»“æ„ä½“çš„å®šä¹‰

\`\`\`c
struct ç»“æ„ä½“å {
    ç±»å‹ æˆå‘˜1;
    ç±»å‹ æˆå‘˜2;
    // ...
};
\`\`\`

### è®¿é—®ç»“æ„ä½“æˆå‘˜

ä½¿ç”¨ \`.\` è¿ç®—ç¬¦ï¼š

\`\`\`c
printf("å§“åï¼š%s\\n", s1.name);
printf("å¹´é¾„ï¼š%d\\n", s1.age);
s1.score = 95.0;  // ä¿®æ”¹æˆç»©
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£ç»“æ„ä½“æ¦‚å¿µ', 'æŒæ¡ç»“æ„ä½“å®šä¹‰å’Œä½¿ç”¨']
  },

  'intro_memory': {
    id: 'intro_memory',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# å†…å­˜æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ

## å¯¼è¯»

æƒ³è±¡ä¸€ä¸‹ï¼Œå†…å­˜å°±åƒä¸€æ’**å‚¨ç‰©æŸœ**ï¼š
- æ¯ä¸ªæŸœå­éƒ½æœ‰ä¸€ä¸ª**ç¼–å·**ï¼ˆåœ°å€ï¼‰
- æ¯ä¸ªæŸœå­å¯ä»¥å­˜æ”¾**ä¸€ä¸ªæ•°æ®**

### å˜é‡ä¸åœ°å€

å½“ä½ å£°æ˜ä¸€ä¸ªå˜é‡æ—¶ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸€ä¸ª"æŸœå­"ç»™å®ƒï¼š

\`\`\`c
int x = 42;
// x å ç”¨äº†æŸä¸ªæŸœå­ï¼Œé‡Œé¢æ”¾ç€ 42
// è¿™ä¸ªæŸœå­æœ‰ä¸€ä¸ªåœ°å€ï¼Œæ¯”å¦‚ 0x7fff5fbff8bc
\`\`\`

### ä»€ä¹ˆæ˜¯æŒ‡é’ˆï¼Ÿ

**æŒ‡é’ˆ**æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œå®ƒå­˜å‚¨çš„ä¸æ˜¯æ™®é€šæ•°æ®ï¼Œè€Œæ˜¯å¦ä¸€ä¸ªå˜é‡çš„**åœ°å€**ã€‚

å°±åƒï¼š
- å˜é‡ = æŸœå­é‡Œçš„ä¸œè¥¿
- æŒ‡é’ˆ = å†™ç€æŸœå­ç¼–å·çš„çº¸æ¡

### & å’Œ * è¿ç®—ç¬¦

| è¿ç®—ç¬¦ | åç§° | ä½œç”¨ |
|--------|------|------|
| \`&\` | å–åœ°å€ | è·å–å˜é‡çš„åœ°å€ |
| \`*\` | è§£å¼•ç”¨ | é€šè¿‡åœ°å€è·å–å€¼ |

\`\`\`c
int x = 42;
int *p = &x;    // p å­˜å‚¨ x çš„åœ°å€

printf("%d\\n", x);   // 42
printf("%p\\n", p);   // 0x7fff... (åœ°å€)
printf("%d\\n", *p);  // 42 (é€šè¿‡åœ°å€å–å€¼)
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£å†…å­˜æ¨¡å‹', 'æŒæ¡æŒ‡é’ˆåŸºç¡€']
  },

  'intro_array': {
    id: 'intro_array',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# æ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿ

## å¯¼è¯»

**æ•°ç»„**æ˜¯ä¸€ç»„**è¿ç»­çš„å‚¨ç‰©æŸœ**ï¼Œç”¨æ¥å­˜æ”¾ç›¸åŒç±»å‹çš„å¤šä¸ªæ•°æ®ã€‚

### æ•°ç»„çš„å£°æ˜å’Œåˆå§‹åŒ–

\`\`\`c
int scores[5] = {85, 90, 78, 92, 88};
// åˆ›å»ºäº† 5 ä¸ªè¿ç»­çš„ int æŸœå­
\`\`\`

### æ•°ç»„çš„è®¿é—®

ä½¿ç”¨**ä¸‹æ ‡**ï¼ˆä» 0 å¼€å§‹ï¼‰è®¿é—®å…ƒç´ ï¼š

\`\`\`c
scores[0]  // ç¬¬1ä¸ªå…ƒç´ ï¼š85
scores[4]  // ç¬¬5ä¸ªå…ƒç´ ï¼š88
scores[5]  // âŒ è¶Šç•Œï¼åªæœ‰ 0-4
\`\`\`

### æ•°ç»„åå°±æ˜¯æŒ‡é’ˆï¼

è¿™æ˜¯ C è¯­è¨€çš„é‡è¦æ¦‚å¿µï¼š

\`\`\`c
int arr[5] = {1, 2, 3, 4, 5};

// arr ç­‰ä»·äº &arr[0]
printf("%p\\n", arr);      // æ•°ç»„é¦–åœ°å€
printf("%p\\n", &arr[0]);  // åŒæ ·çš„åœ°å€

// ä¸¤ç§ç­‰ä»·çš„è®¿é—®æ–¹å¼
arr[2]       // ä¸‹æ ‡è®¿é—®
*(arr + 2)   // æŒ‡é’ˆè®¿é—®
\`\`\`

### æ•°ç»„éå†

\`\`\`c
int arr[5] = {1, 2, 3, 4, 5};
for (int i = 0; i < 5; i++) {
    printf("%d ", arr[i]);
}
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£æ•°ç»„æ¦‚å¿µ', 'æŒæ¡æ•°ç»„ä¸æŒ‡é’ˆçš„å…³ç³»']
  },

  'intro_testing': {
    id: 'intro_testing',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä¸ºä»€ä¹ˆè¦æµ‹è¯•ï¼Ÿ

## å¯¼è¯»

ä½ å†™çš„ä»£ç èƒ½è¿è¡Œï¼Œä¸ä»£è¡¨å®ƒæ˜¯å¯¹çš„ã€‚**æµ‹è¯•**æ˜¯å‘ç° bug çš„é‡è¦æ‰‹æ®µã€‚

### ä¸€ä¸ªä¾‹å­

å‡è®¾ä½ å†™äº†ä¸€ä¸ªåˆ¤æ–­ç´ æ•°çš„å‡½æ•°ï¼š

\`\`\`c
int isPrime(int n) {
    for (int i = 2; i < n; i++) {
        if (n % i == 0) return 0;
    }
    return 1;
}
\`\`\`

çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Ÿä½†å¦‚æœè¾“å…¥ **1** ä¼šæ€æ ·ï¼Ÿè¾“å…¥ **0** å‘¢ï¼Ÿè¾“å…¥ **-5** å‘¢ï¼Ÿ

### æµ‹è¯•çš„ç±»å‹

1. **é»‘ç›’æµ‹è¯•**ï¼šä¸çœ‹ä»£ç ï¼Œåªæ ¹æ®åŠŸèƒ½è®¾è®¡æµ‹è¯•
2. **ç™½ç›’æµ‹è¯•**ï¼šçœ‹ä»£ç ï¼Œé’ˆå¯¹å®ç°ç»†èŠ‚è®¾è®¡æµ‹è¯•

### è¾¹ç•Œå€¼æµ‹è¯•

æœ€å®¹æ˜“å‡º bug çš„åœ°æ–¹å¾€å¾€æ˜¯**è¾¹ç•Œ**ï¼š

- 0ã€1ã€-1
- æœ€å¤§å€¼ã€æœ€å°å€¼
- ç©ºæ•°ç»„ã€å•å…ƒç´ æ•°ç»„
- åˆšå¥½ç­‰äºä¸´ç•Œå€¼

### æµ‹è¯•ç”¨ä¾‹è®¾è®¡

å¥½çš„æµ‹è¯•åº”è¯¥è¦†ç›–ï¼š
- âœ… æ­£å¸¸æƒ…å†µ
- âœ… è¾¹ç•Œæƒ…å†µ
- âœ… å¼‚å¸¸/é”™è¯¯è¾“å…¥

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['ç†è§£æµ‹è¯•çš„é‡è¦æ€§', 'æŒæ¡è¾¹ç•Œå€¼æµ‹è¯•']
  },

  'intro_gdb': {
    id: 'intro_gdb',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# ä»€ä¹ˆæ˜¯è°ƒè¯•å™¨ï¼Ÿ

## å¯¼è¯»

å½“ç¨‹åºå‡ºé”™æ—¶ï¼Œä½ æ˜¯æ€ä¹ˆæ‰¾ bug çš„ï¼Ÿåˆ°å¤„åŠ  \`printf\`ï¼Ÿ

æœ‰æ›´å¥½çš„åŠæ³•ï¼šä½¿ç”¨**è°ƒè¯•å™¨ (Debugger)**ã€‚

### GDB ç®€ä»‹

**GDB (GNU Debugger)** æ˜¯ Linux ä¸‹æœ€å¸¸ç”¨çš„è°ƒè¯•å·¥å…·ã€‚å®ƒå¯ä»¥ï¼š

- **æš‚åœç¨‹åº**ï¼šåœ¨æŒ‡å®šä½ç½®åœä¸‹æ¥
- **å•æ­¥æ‰§è¡Œ**ï¼šä¸€è¡Œä¸€è¡Œåœ°è¿è¡Œ
- **æŸ¥çœ‹å˜é‡**ï¼šæ£€æŸ¥å˜é‡çš„å½“å‰å€¼
- **è¿½è¸ªè°ƒç”¨**ï¼šçœ‹å‡½æ•°æ˜¯æ€ä¹ˆè¢«è°ƒç”¨çš„

### GDB åŸºæœ¬å‘½ä»¤

| å‘½ä»¤ | ä½œç”¨ |
|------|------|
| \`gdb ./ç¨‹åºå\` | å¯åŠ¨è°ƒè¯• |
| \`break main\` | åœ¨ main å‡½æ•°è®¾ç½®æ–­ç‚¹ |
| \`break 10\` | åœ¨ç¬¬ 10 è¡Œè®¾ç½®æ–­ç‚¹ |
| \`run\` | å¼€å§‹è¿è¡Œç¨‹åº |
| \`next\` | æ‰§è¡Œä¸‹ä¸€è¡Œï¼ˆä¸è¿›å…¥å‡½æ•°ï¼‰ |
| \`step\` | æ‰§è¡Œä¸‹ä¸€è¡Œï¼ˆè¿›å…¥å‡½æ•°ï¼‰ |
| \`print x\` | æ‰“å°å˜é‡ x çš„å€¼ |
| \`continue\` | ç»§ç»­è¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ |
| \`quit\` | é€€å‡º GDB |

### è°ƒè¯•çš„åŸºæœ¬æµç¨‹

1. \`gdb ./ç¨‹åº\` â€” åŠ è½½ç¨‹åº
2. \`break main\` â€” è®¾ç½®æ–­ç‚¹
3. \`run\` â€” è¿è¡Œ
4. \`next\` / \`print\` â€” å•æ­¥æ‰§è¡Œï¼Œè§‚å¯Ÿå˜é‡
5. å‘ç° bugï¼

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['äº†è§£è°ƒè¯•å™¨', 'æŒæ¡ GDB åŸºæœ¬å‘½ä»¤']
  },

  'intro_poker_project': {
    id: 'intro_poker_project',
    displayType: 'reading',
    editableFiles: [],
    descriptionZh: `# æ‰‘å…‹ç‰Œé¡¹ç›®ä»‹ç»

## å¯¼è¯»

æ­å–œä½ æ¥åˆ°ç»¼åˆé¡¹ç›®é˜¶æ®µï¼åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œä½ å°†å®ç°ä¸€ä¸ª**æ‰‘å…‹ç‰Œè¯„ä¼°ç³»ç»Ÿ**ã€‚

### é¡¹ç›®ç›®æ ‡

å®ç°ä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥ï¼š
1. è¡¨ç¤ºä¸€å¼ æ‰‘å…‹ç‰Œï¼ˆèŠ±è‰² + ç‚¹æ•°ï¼‰
2. åˆ¤æ–­ç‰Œå‹ï¼ˆå¯¹å­ã€é¡ºå­ã€åŒèŠ±ç­‰ï¼‰
3. æ¯”è¾ƒä¸¤æ‰‹ç‰Œçš„å¤§å°

### çŸ¥è¯†ç‚¹å›é¡¾

è¿™ä¸ªé¡¹ç›®å°†ç»¼åˆè¿ç”¨ä½ å­¦åˆ°çš„æ‰€æœ‰çŸ¥è¯†ï¼š

- **ç»“æ„ä½“**ï¼šè¡¨ç¤ºå¡ç‰Œ
- **æšä¸¾**ï¼šè¡¨ç¤ºèŠ±è‰²å’Œç‚¹æ•°
- **å‡½æ•°**ï¼šå°è£…å„ç§æ“ä½œ
- **æ•°ç»„**ï¼šå­˜å‚¨ä¸€æ‰‹ç‰Œ
- **æµ‹è¯•**ï¼šéªŒè¯æ­£ç¡®æ€§

### é¡¹ç›®ç»“æ„

\`\`\`
cards.h    â€” å¤´æ–‡ä»¶ï¼Œå®šä¹‰æ•°æ®ç±»å‹å’Œå‡½æ•°åŸå‹
cards.c    â€” å®ç°æ–‡ä»¶ï¼Œç¼–å†™å‡½æ•°å®ç°
test.c     â€” æµ‹è¯•æ–‡ä»¶
\`\`\`

### æšä¸¾ç±»å‹

æœ¬é¡¹ç›®ä¼šç”¨åˆ°**æšä¸¾ (enum)**ï¼Œå®ƒç”¨æ¥å®šä¹‰ä¸€ç»„å‘½åçš„å¸¸é‡ï¼š

\`\`\`c
typedef enum {
    SPADES,   // é»‘æ¡ƒ = 0
    HEARTS,   // çº¢å¿ƒ = 1
    DIAMONDS, // æ–¹å— = 2
    CLUBS     // æ¢…èŠ± = 3
} suit_t;
\`\`\`

---

é˜…è¯»å®Œæˆåï¼Œè¯·ç‚¹å‡»"å®Œæˆé˜…è¯»"ç»§ç»­ä¸‹ä¸€æ­¥ã€‚`,
    learningGoals: ['äº†è§£é¡¹ç›®ç»“æ„', 'å¤ä¹ ç»¼åˆçŸ¥è¯†ç‚¹']
  },

  // ============================================================
  // æ–°å¢ï¼šä»£ç ç»ƒä¹ é¢˜
  // ============================================================

  'code_swap_vars': {
    id: 'code_swap_vars',
    displayType: 'standard',
    editableFiles: ['swap.c'],
    descriptionZh: `# äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼

## ä»»åŠ¡æè¿°
ç¼–å†™ä»£ç ï¼Œäº¤æ¢ä¸¤ä¸ªå˜é‡ a å’Œ b çš„å€¼ã€‚

## å…·ä½“è¦æ±‚
1. ç»™å®šä¸¤ä¸ªæ•´æ•°å˜é‡ a å’Œ b
2. ä½¿ç”¨ç¬¬ä¸‰ä¸ªä¸´æ—¶å˜é‡ tempï¼Œäº¤æ¢å®ƒä»¬çš„å€¼
3. æ‰“å°äº¤æ¢åçš„ç»“æœ

## ç¤ºä¾‹
\`\`\`
äº¤æ¢å‰: a=5, b=10
äº¤æ¢å: a=10, b=5
\`\`\`

## æç¤º
- æƒ³ä¸€æƒ³ï¼šå¦‚æœæ²¡æœ‰ tempï¼Œç›´æ¥ a = b ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

## æŒ‘æˆ˜ï¼ˆé€‰åšï¼‰
èƒ½å¦ä¸ä½¿ç”¨ç¬¬ä¸‰ä¸ªå˜é‡å®Œæˆäº¤æ¢ï¼Ÿï¼ˆæç¤ºï¼šå¼‚æˆ–è¿ç®—ï¼‰`,
    learningGoals: ['å˜é‡èµ‹å€¼', 'ä¸´æ—¶å˜é‡çš„ä½¿ç”¨']
  },

  'code_grade_judge': {
    id: 'code_grade_judge',
    displayType: 'standard',
    editableFiles: ['grade.c'],
    descriptionZh: `# æˆç»©ç­‰çº§åˆ¤æ–­

## ä»»åŠ¡æè¿°
æ ¹æ®åˆ†æ•°è¾“å‡ºå¯¹åº”çš„ç­‰çº§ã€‚

## å…·ä½“è¦æ±‚
| åˆ†æ•°èŒƒå›´ | ç­‰çº§ |
|----------|------|
| 90-100 | A |
| 80-89 | B |
| 70-79 | C |
| 60-69 | D |
| 0-59 | F |

## ç¤ºä¾‹
\`\`\`
è¾“å…¥: 85
è¾“å‡º: B
\`\`\`

## æç¤º
- ä½¿ç”¨ if-else if-else ç»“æ„
- æ³¨æ„è¾¹ç•Œå€¼çš„å¤„ç†`,
    learningGoals: ['å¤šåˆ†æ”¯æ¡ä»¶', 'è¾¹ç•Œå¤„ç†']
  },

  'code_sum_1_to_n': {
    id: 'code_sum_1_to_n',
    displayType: 'standard',
    editableFiles: ['sum.c'],
    descriptionZh: `# è®¡ç®— 1+2+...+N

## ä»»åŠ¡æè¿°
ä½¿ç”¨å¾ªç¯è®¡ç®—ä» 1 åˆ° N çš„ç´¯åŠ å’Œã€‚

## å…·ä½“è¦æ±‚
1. è¯»å…¥ä¸€ä¸ªæ­£æ•´æ•° N
2. è®¡ç®— 1+2+3+...+N
3. è¾“å‡ºç»“æœ

## ç¤ºä¾‹
\`\`\`
è¾“å…¥: 10
è¾“å‡º: 55
\`\`\`

## æç¤º
- ä½¿ç”¨ for å¾ªç¯
- éœ€è¦ä¸€ä¸ªå˜é‡æ¥ç´¯åŠ ç»“æœ`,
    learningGoals: ['for å¾ªç¯', 'ç´¯åŠ å™¨æ¨¡å¼']
  },

  'code_factorial': {
    id: 'code_factorial',
    displayType: 'standard',
    editableFiles: ['factorial.c'],
    descriptionZh: `# è®¡ç®—é˜¶ä¹˜

## ä»»åŠ¡æè¿°
è®¡ç®— N çš„é˜¶ä¹˜ï¼šN! = 1 Ã— 2 Ã— 3 Ã— ... Ã— N

## å…·ä½“è¦æ±‚
1. è¯»å…¥ä¸€ä¸ªéè´Ÿæ•´æ•° N
2. è®¡ç®— N!
3. æ³¨æ„ï¼š0! = 1

## ç¤ºä¾‹
\`\`\`
è¾“å…¥: 5
è¾“å‡º: 120  (å› ä¸º 5! = 1Ã—2Ã—3Ã—4Ã—5 = 120)
\`\`\`

## æç¤º
- ç±»ä¼¼ç´¯åŠ ï¼Œä½†è¿™æ¬¡æ˜¯ç´¯ä¹˜
- ç‰¹åˆ«å¤„ç† N=0 çš„æƒ…å†µ`,
    learningGoals: ['å¾ªç¯', 'ç´¯ä¹˜å™¨æ¨¡å¼']
  },

  'code_is_even': {
    id: 'code_is_even',
    displayType: 'standard',
    editableFiles: ['even.c'],
    descriptionZh: `# åˆ¤æ–­å¥‡å¶

## ä»»åŠ¡æè¿°
ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­æ•´æ•°æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ã€‚

## å…·ä½“è¦æ±‚
å®ç°å‡½æ•°ï¼š
\`\`\`c
int isEven(int n);
\`\`\`
- å¦‚æœ n æ˜¯å¶æ•°ï¼Œè¿”å› 1
- å¦‚æœ n æ˜¯å¥‡æ•°ï¼Œè¿”å› 0

## æç¤º
- å¶æ•°é™¤ä»¥ 2 ä½™æ•°ä¸º 0
- ä½¿ç”¨å–æ¨¡è¿ç®—ç¬¦ %`,
    learningGoals: ['å‡½æ•°å®šä¹‰', 'å–æ¨¡è¿ç®—']
  },

  'code_is_prime': {
    id: 'code_is_prime',
    displayType: 'standard',
    editableFiles: ['prime.c'],
    descriptionZh: `# åˆ¤æ–­ç´ æ•°

## ä»»åŠ¡æè¿°
ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­æ•´æ•°æ˜¯å¦ä¸ºç´ æ•°ã€‚

## ç´ æ•°å®šä¹‰
- å¤§äº 1 çš„è‡ªç„¶æ•°
- é™¤äº† 1 å’Œè‡ªèº«å¤–ï¼Œä¸èƒ½è¢«å…¶ä»–è‡ªç„¶æ•°æ•´é™¤
- ä¾‹å¦‚ï¼š2, 3, 5, 7, 11, 13...

## å…·ä½“è¦æ±‚
å®ç°å‡½æ•°ï¼š
\`\`\`c
int isPrime(int n);
\`\`\`
- å¦‚æœ n æ˜¯ç´ æ•°ï¼Œè¿”å› 1
- å¦åˆ™ï¼Œè¿”å› 0

## æç¤º
- 1 ä¸æ˜¯ç´ æ•°
- 2 æ˜¯æœ€å°çš„ç´ æ•°
- åªéœ€æ£€æŸ¥åˆ° âˆšn å³å¯ï¼ˆæƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆï¼Ÿï¼‰`,
    learningGoals: ['å‡½æ•°å®ç°', 'ç®—æ³•ä¼˜åŒ–']
  },

  'code_swap_ptr': {
    id: 'code_swap_ptr',
    displayType: 'standard',
    editableFiles: ['swap_ptr.c'],
    descriptionZh: `# ç”¨æŒ‡é’ˆäº¤æ¢å˜é‡

## ä»»åŠ¡æè¿°
ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡æŒ‡é’ˆäº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ã€‚

## å…·ä½“è¦æ±‚
å®ç°å‡½æ•°ï¼š
\`\`\`c
void swap(int *a, int *b);
\`\`\`

è°ƒç”¨åï¼Œ\`a\` å’Œ \`b\` æŒ‡å‘çš„å€¼è¢«äº¤æ¢ã€‚

## ç¤ºä¾‹
\`\`\`c
int x = 5, y = 10;
swap(&x, &y);
// ç°åœ¨ x=10, y=5
\`\`\`

## æ€è€ƒé¢˜
ä¸ºä»€ä¹ˆä¹‹å‰çš„ \`swap(int a, int b)\` ä¸èµ·ä½œç”¨ï¼Ÿ

## æç¤º
- ä½¿ç”¨è§£å¼•ç”¨ \`*\` è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„å€¼
- éœ€è¦ä¸€ä¸ªä¸´æ—¶å˜é‡`,
    learningGoals: ['æŒ‡é’ˆå‚æ•°', 'ä¼ å¼•ç”¨']
  },

  'code_array_reverse': {
    id: 'code_array_reverse',
    displayType: 'standard',
    editableFiles: ['reverse.c'],
    descriptionZh: `# æ•°ç»„åè½¬

## ä»»åŠ¡æè¿°
å°†æ•°ç»„ä¸­çš„å…ƒç´ å€’åºæ’åˆ—ã€‚

## å…·ä½“è¦æ±‚
å®ç°å‡½æ•°ï¼š
\`\`\`c
void reverse(int arr[], int n);
\`\`\`

å°†é•¿åº¦ä¸º n çš„æ•°ç»„ arr åŸåœ°åè½¬ã€‚

## ç¤ºä¾‹
\`\`\`
è¾“å…¥: [1, 2, 3, 4, 5]
è¾“å‡º: [5, 4, 3, 2, 1]
\`\`\`

## æç¤º
- ä½¿ç”¨åŒæŒ‡é’ˆæ³•ï¼šä¸€ä¸ªä»å¤´ï¼Œä¸€ä¸ªä»å°¾
- äº¤æ¢å¯¹åº”ä½ç½®çš„å…ƒç´ 
- ä½•æ—¶åœæ­¢ï¼Ÿ`,
    learningGoals: ['æ•°ç»„æ“ä½œ', 'åŒæŒ‡é’ˆ']
  }
};

// ============================================================
// Quiz é¢˜ç›®é…ç½®
// ============================================================

export type QuizProblem =
  | {
      kind: 'single';
      prompt: string;
      options: { id: string; text: string }[];
      correctOptionId: string;
      explanation?: string;
    }
  | {
      kind: 'true_false';
      prompt: string;
      correct: boolean;
      explanation?: string;
    }
  | {
      kind: 'fill';
      prompt: string;
      acceptableAnswers: string[];
      explanation?: string;
    };

const QUIZ_PROBLEMS: Record<string, QuizProblem> = {
  // æ¨¡å—1ï¼šç¼–è¯‘æ¦‚å¿µ
  qz_compile_concept: {
    kind: 'true_false',
    prompt: 'åˆ¤æ–­é¢˜ï¼šCè¯­è¨€çš„æºä»£ç (.cæ–‡ä»¶)å¯ä»¥ç›´æ¥è¢«è®¡ç®—æœºæ‰§è¡Œã€‚',
    correct: false,
    explanation: 'Cè¯­è¨€æ˜¯ç¼–è¯‘å‹è¯­è¨€ï¼Œæºä»£ç éœ€è¦å…ˆè¢«ç¼–è¯‘å™¨(gcc)ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰èƒ½è¿è¡Œã€‚'
  },
  qz_c_basics_mcq_1: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šä¸‹é¢å“ªæ¡å‘½ä»¤å¯ä»¥æŠŠ `hello.c` ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ `hello`ï¼Ÿ',
    options: [
      { id: 'A', text: 'gcc hello.c -o hello' },
      { id: 'B', text: 'gcc -c hello.c -o hello' },
      { id: 'C', text: './hello.c -o hello' },
      { id: 'D', text: 'clang-run hello.c' }
    ],
    correctOptionId: 'A',
    explanation: 'gcc é»˜è®¤ä¼šé“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼›-c åªç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆ.oï¼‰ã€‚'
  },

  // æ¨¡å—2ï¼šå˜é‡
  qz_variable_types: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šä¸‹é¢å“ªç§æ•°æ®ç±»å‹ç”¨æ¥å­˜å‚¨å°æ•°ï¼Ÿ',
    options: [
      { id: 'A', text: 'int' },
      { id: 'B', text: 'char' },
      { id: 'C', text: 'float' },
      { id: 'D', text: 'void' }
    ],
    correctOptionId: 'C',
    explanation: 'int å­˜æ•´æ•°ï¼Œchar å­˜å­—ç¬¦ï¼Œfloat å­˜å°æ•°ï¼Œvoid è¡¨ç¤ºæ— ç±»å‹ã€‚'
  },
  qz_c_printf_fill_1: {
    kind: 'fill',
    prompt: 'å¡«ç©ºé¢˜ï¼š`printf` æ‰“å°ä¸€ä¸ª `int` å¸¸ç”¨çš„æ ¼å¼åŒ–å ä½ç¬¦æ˜¯ ______ ã€‚',
    acceptableAnswers: ['%d', '%i'],
    explanation: '`%d` å’Œ `%i` éƒ½å¯ç”¨äºè¾“å‡ºåè¿›åˆ¶æ•´æ•°ã€‚'
  },

  // æ¨¡å—3ï¼šæ¡ä»¶åˆ¤æ–­
  qz_c_controlflow_tf_1: {
    kind: 'true_false',
    prompt: 'åˆ¤æ–­é¢˜ï¼šåœ¨ C è¯­è¨€ä¸­ï¼Œ`if (x)` å½“ `x == 0` æ—¶ä¸ºå‡ï¼Œ`x != 0` æ—¶ä¸ºçœŸã€‚',
    correct: true,
    explanation: 'C è¯­è¨€æŠŠ 0 è§†ä¸º falseï¼Œä»»ä½•é 0 å€¼éƒ½è§†ä¸º trueã€‚'
  },
  qz_logic_operators: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šè¡¨è¾¾å¼ `(5 > 3) && (2 < 1)` çš„ç»“æœæ˜¯ï¼Ÿ',
    options: [
      { id: 'A', text: '1ï¼ˆçœŸï¼‰' },
      { id: 'B', text: '0ï¼ˆå‡ï¼‰' },
      { id: 'C', text: 'ç¼–è¯‘é”™è¯¯' },
      { id: 'D', text: 'æœªå®šä¹‰' }
    ],
    correctOptionId: 'B',
    explanation: '5>3 ä¸ºçœŸ(1)ï¼Œ2<1 ä¸ºå‡(0)ã€‚&& è¡¨ç¤º"ä¸"ï¼Œä¸¤è¾¹éƒ½ä¸ºçœŸæ‰ä¸ºçœŸã€‚1 && 0 = 0ã€‚'
  },

  // æ¨¡å—4ï¼šå¾ªç¯
  qz_loop_types: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šå¦‚æœæƒ³è®©ä»£ç è‡³å°‘æ‰§è¡Œä¸€æ¬¡ï¼Œåº”è¯¥ç”¨å“ªç§å¾ªç¯ï¼Ÿ',
    options: [
      { id: 'A', text: 'for å¾ªç¯' },
      { id: 'B', text: 'while å¾ªç¯' },
      { id: 'C', text: 'do-while å¾ªç¯' },
      { id: 'D', text: 'ä»¥ä¸Šéƒ½å¯ä»¥' }
    ],
    correctOptionId: 'C',
    explanation: 'do-while å…ˆæ‰§è¡Œååˆ¤æ–­ï¼Œä¿è¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚while å’Œ for æ˜¯å…ˆåˆ¤æ–­åæ‰§è¡Œã€‚'
  },

  // æ¨¡å—5ï¼šå‡½æ•°
  qz_function_syntax: {
    kind: 'fill',
    prompt: 'å¡«ç©ºé¢˜ï¼šå®šä¹‰ä¸€ä¸ªè¿”å›æ•´æ•°çš„å‡½æ•° maxï¼Œæ¥å—ä¸¤ä¸ªæ•´æ•°å‚æ•° a å’Œ bï¼Œå‡½æ•°å£°æ˜åº”è¯¥æ˜¯ï¼š______ max(int a, int b);',
    acceptableAnswers: ['int'],
    explanation: 'å‡½æ•°çš„è¿”å›ç±»å‹å†™åœ¨å‡½æ•°åå‰é¢ã€‚è¿™é‡Œè¿”å›æ•´æ•°ï¼Œæ‰€ä»¥æ˜¯ intã€‚'
  },

  // æ¨¡å—6ï¼šç»“æ„ä½“
  qz_struct_syntax: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šå¦‚æœ `struct Point { int x; int y; }; struct Point p;`ï¼Œå¦‚ä½•è®¿é—® p çš„ x æˆå‘˜ï¼Ÿ',
    options: [
      { id: 'A', text: 'p->x' },
      { id: 'B', text: 'p.x' },
      { id: 'C', text: 'p[x]' },
      { id: 'D', text: '*p.x' }
    ],
    correctOptionId: 'B',
    explanation: 'å¯¹äºç»“æ„ä½“å˜é‡ï¼Œä½¿ç”¨ . è®¿é—®æˆå‘˜ã€‚-> ç”¨äºç»“æ„ä½“æŒ‡é’ˆã€‚'
  },

  // æ¨¡å—7ï¼šæŒ‡é’ˆ
  qz_pointer_basics: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼š`int x = 10; int *p = &x;`ï¼Œåˆ™ `*p` çš„å€¼æ˜¯ï¼Ÿ',
    options: [
      { id: 'A', text: 'x çš„åœ°å€' },
      { id: 'B', text: '10' },
      { id: 'C', text: 'p çš„åœ°å€' },
      { id: 'D', text: 'ç¼–è¯‘é”™è¯¯' }
    ],
    correctOptionId: 'B',
    explanation: '* æ˜¯è§£å¼•ç”¨è¿ç®—ç¬¦ï¼Œ*p è·å– p æŒ‡å‘çš„å€¼ï¼Œå³ x çš„å€¼ 10ã€‚'
  },

  // æ¨¡å—8ï¼šæ•°ç»„
  qz_array_ptr: {
    kind: 'true_false',
    prompt: 'åˆ¤æ–­é¢˜ï¼šå¯¹äºæ•°ç»„ `int arr[5]`ï¼Œ`arr[2]` å’Œ `*(arr+2)` æ˜¯ç­‰ä»·çš„ã€‚',
    correct: true,
    explanation: 'æ•°ç»„åæ˜¯æŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆï¼Œarr[i] ç­‰ä»·äº *(arr+i)ã€‚'
  },

  // æ¨¡å—9ï¼šæµ‹è¯•
  qz_test_types: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šä¸çœ‹æºä»£ç ï¼Œåªæ ¹æ®åŠŸèƒ½éœ€æ±‚è®¾è®¡æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™å«åšï¼Ÿ',
    options: [
      { id: 'A', text: 'ç™½ç›’æµ‹è¯•' },
      { id: 'B', text: 'é»‘ç›’æµ‹è¯•' },
      { id: 'C', text: 'ç°ç›’æµ‹è¯•' },
      { id: 'D', text: 'å›å½’æµ‹è¯•' }
    ],
    correctOptionId: 'B',
    explanation: 'é»‘ç›’æµ‹è¯•ä¸å…³å¿ƒå†…éƒ¨å®ç°ï¼Œåªæµ‹è¯•è¾“å…¥è¾“å‡ºã€‚ç™½ç›’æµ‹è¯•éœ€è¦çœ‹ä»£ç ã€‚'
  },
  qz_boundary_test: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šæµ‹è¯•åˆ¤æ–­ç´ æ•°çš„å‡½æ•°ï¼Œä»¥ä¸‹å“ªä¸ªæ˜¯æœ€é‡è¦çš„è¾¹ç•Œå€¼ï¼Ÿ',
    options: [
      { id: 'A', text: '100' },
      { id: 'B', text: '7' },
      { id: 'C', text: '1' },
      { id: 'D', text: '17' }
    ],
    correctOptionId: 'C',
    explanation: '1 æ˜¯è¾¹ç•Œå€¼ï¼ˆä¸æ˜¯ç´ æ•°ï¼Œä½†å®¹æ˜“è¢«è¯¯åˆ¤ï¼‰ã€‚100ã€7ã€17 éƒ½æ˜¯æ™®é€šæµ‹è¯•ç”¨ä¾‹ã€‚'
  },

  // æ¨¡å—10ï¼šGDB
  qz_gdb_commands: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼šåœ¨ GDB ä¸­ï¼Œå“ªä¸ªå‘½ä»¤ç”¨äºè®¾ç½®æ–­ç‚¹ï¼Ÿ',
    options: [
      { id: 'A', text: 'run' },
      { id: 'B', text: 'break' },
      { id: 'C', text: 'print' },
      { id: 'D', text: 'next' }
    ],
    correctOptionId: 'B',
    explanation: 'break è®¾ç½®æ–­ç‚¹ï¼Œrun è¿è¡Œç¨‹åºï¼Œprint æ‰“å°å˜é‡ï¼Œnext å•æ­¥æ‰§è¡Œã€‚'
  },

  // æ¨¡å—11ï¼šæšä¸¾
  qz_enum_basics: {
    kind: 'single',
    prompt: 'é€‰æ‹©é¢˜ï¼š`enum Color { RED, GREEN, BLUE };` ä¸­ï¼ŒGREEN çš„å€¼æ˜¯ï¼Ÿ',
    options: [
      { id: 'A', text: '0' },
      { id: 'B', text: '1' },
      { id: 'C', text: '2' },
      { id: 'D', text: 'GREEN' }
    ],
    correctOptionId: 'B',
    explanation: 'æšä¸¾ä» 0 å¼€å§‹è‡ªåŠ¨ç¼–å·ã€‚RED=0, GREEN=1, BLUE=2ã€‚'
  }
};

// ============================================================
// å…¬å…± API
// ============================================================

export function getEditableFilename(problemId: string): string | undefined {
  const meta = PROBLEM_META[problemId];
  if (!meta) return undefined;
  return meta.editableFiles[0];
}

export function getEditableFilenames(problemId: string): string[] {
  const meta = PROBLEM_META[problemId];
  if (!meta) return [];
  return meta.editableFiles;
}

export function getReadonlyFilenames(problemId: string): string[] {
  const meta = PROBLEM_META[problemId];
  if (!meta) return [];
  return meta.readonlyFiles || [];
}

export function getProblemMeta(problemId: string): ProblemMeta | undefined {
  return PROBLEM_META[problemId];
}

export function getProblemKind(problemId: string): ProblemKind {
  if (QUIZ_PROBLEMS[problemId]) return 'quiz';
  const meta = PROBLEM_META[problemId];
  // æ£€æŸ¥æ˜¯å¦æ˜¯å¯¼è¯»è¯¾ï¼ˆintro å¼€å¤´çš„ ID æˆ– displayType ä¸º reading ä¸”æ— å¯ç¼–è¾‘æ–‡ä»¶ï¼‰
  if (problemId.startsWith('intro_')) return 'intro';
  if (meta?.displayType === 'reading' && (!meta.editableFiles || meta.editableFiles.length === 0)) {
    return 'intro';
  }
  if (meta?.displayType === 'reading') return 'reading';
  return 'code';
}

export function getQuizProblem(problemId: string): QuizProblem | undefined {
  return QUIZ_PROBLEMS[problemId];
}

// æ ¹ç›®å½•
const PROJECT_ROOT = path.resolve(process.cwd(), '..'); 

export async function getProblemContent(problemId: string) {
  const kind = getProblemKind(problemId);
  
  // Quiz é¢˜ç›®
  if (kind === 'quiz') {
    const quiz = getQuizProblem(problemId)!;
    return {
      kind,
      description: quiz.prompt,
      initialCode: '',
      initialFiles: {},
      editableFilenames: [],
      readonlyFiles: {},
      quiz
    };
  }

  const meta = PROBLEM_META[problemId];
  const dirPath = path.join(PROJECT_ROOT, problemId);
  
  // è·å–æè¿°
  let description = '';
  if (meta?.descriptionZh) {
    description = meta.descriptionZh;
  } else {
    // å°è¯•è¯»å– README
    try {
      description = await fs.readFile(path.join(dirPath, 'README'), 'utf-8');
    } catch {
      description = 'æš‚æ— é¢˜ç›®æè¿°ã€‚';
    }
  }

  // è¯»å–å¯ç¼–è¾‘æ–‡ä»¶
  const editableFilenames = meta?.editableFiles || [];
  const initialFiles: Record<string, string> = {};
  
    for (const filename of editableFilenames) {
    try {
      initialFiles[filename] = await fs.readFile(path.join(dirPath, filename), 'utf-8');
    } catch {
      initialFiles[filename] = getDefaultContent(filename);
    }
  }

  // è¯»å–åªè¯»æ–‡ä»¶
  const readonlyFilenames = meta?.readonlyFiles || [];
  const readonlyFiles: Record<string, string> = {};
  
  for (const filename of readonlyFilenames) {
    try {
      readonlyFiles[filename] = await fs.readFile(path.join(dirPath, filename), 'utf-8');
    } catch {
      // åªè¯»æ–‡ä»¶è¯»å–å¤±è´¥ä¸å¡«å……é»˜è®¤å†…å®¹
      }
    }

  const initialCode = editableFilenames.length > 0 ? (initialFiles[editableFilenames[0]] || '') : '';

  return {
    kind,
    displayType: meta?.displayType || 'standard',
    description,
    initialCode,
    initialFiles,
    editableFilenames,
    readonlyFiles,
    readonlyFilenames,
    learningGoals: meta?.learningGoals,
    hints: meta?.hints
  };
}

function getDefaultContent(filename: string): string {
  if (filename.endsWith('.c')) {
    return `#include <stdio.h>
#include <stdlib.h>

int main(void) {
    // åœ¨è¿™é‡Œç¼–å†™ä½ çš„ä»£ç 
    
    return EXIT_SUCCESS;
}
`;
  }
  if (filename.endsWith('.h')) {
    return `#ifndef ${filename.replace('.h', '_H').toUpperCase()}
#define ${filename.replace('.h', '_H').toUpperCase()}

// åœ¨è¿™é‡Œæ·»åŠ å£°æ˜

#endif
`;
  }
  if (filename === 'Makefile') {
    return `# Makefile

all: main

main: main.c
\tgcc -o main -Wall -Werror main.c

clean:
\trm -f main
`;
  }
  if (filename.endsWith('.txt')) {
    return '';
  }
  return '// è¯·ç¼–å†™ä½ çš„ä»£ç \n';
}
